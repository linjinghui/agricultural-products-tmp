<div class="modal-header">
	<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
		<li class="fa fa-remove"></li>
	</button>
	<h5 class="modal-title">认证/h5>
</div>
					<div class="modal-body">
						<form class="form-horizontal" id="certification_form" name="certification_form">
							<div class="box-body" id="divname">
								<input type="hidden" name="certId" id="certId">
								<input type="hidden" name="entId" id="entId">

								<div class="form-group">
									<label for="certType" class="col-sm-2 control-label">认证类型:</label>
									<div class="col-sm-3">
										<select class="form-control select2" style="width: 215px;" data-code="certificateType" data-flag="dictSelector" name="certType" data-text="dictName" data-value="dictCode" data-placeholder="请选择认证类型" style="width:130px;" data-blank="true">
										</select>
									</div>
									<div class="col-sm-1">
										<span class="spanred">*</span>
									</div>

								</div>

								<div class="form-group">
									<label for="certNo" class="col-sm-2 control-label">证书编号:</label>

									<div class="col-sm-3">
										<input type="text" class="form-control" placeholder="" name="certNo" id="certNo">

									</div>
									<div class="col-sm-1">
										<span class="spanred">*</span>
									</div>

								</div>
								<div class="form-group">
									<label for="certIssueDate" class="col-sm-2 control-label">发证日期:</label>
									<div class="col-sm-3">
										<input type="text" class="form-control" placeholder="请选择" data-flag="datepicker" data-format="yyyy-mm-dd" 
										 id="certIssueDate" name="certIssueDate" value="">
									</div>
									<div class="col-sm-1">
										<span class="spanred">*</span>
									</div>

								</div>
								<div class="form-group">
									<label for="certValidEndDate" class="col-sm-2 control-label">有效日期:</label>

									<div class="col-sm-3">
										<input type="text" class="form-control" placeholder="请选择" data-flag="datepicker" data-format="yyyy-mm-dd" id="certValidEndDate" name="certValidEndDate" value="">
									</div>
									<div class="col-sm-0">
										<span class="spanred">*</span>
									</div>

								</div>
								<div class="form-group">
									<label for="certProduct" class="col-sm-2 control-label">认证产品:</label>

									<div class="col-sm-3">
										<input type="text" class="form-control" placeholder="多个产品以英文逗号分开" name="certProduct" id="certProduct">

									</div>

								</div>
								<div class="form-group">
									<label for="remark" class="col-sm-2 control-label">备注:</label>
									<div class="col-xs-8">
										<textarea class="form-control" rows="3" placeholder="" name="remark" id="remark"></textarea>
									</div>

								</div>


								<!-- /.box-body -->
								<input type="hidden" name="fileIds" id="fileIds" value="">
								<div class="form-group" id="file_container">
									<label class="col-sm-2 control-label" for="file">认证图片</label>
									<div class="col-xs-8">
										<input type="file" id="file" name="file">
									</div>
								</div>
								
								<div class="box-footer text-right">
									<!--以下两种方式提交验证,根据所需选择-->
									<button type="button" class="btn btn-default" data-btn-type="cancel" data-dismiss="modal">取消</button>
									<button type="submit" id="save" class="btn btn-primary" data-btn-type="save">提交</button>
								</div>

							</div>
							
						</form>
					</div>

	<script type="text/javascript">
		
		var entId = $("#main_entId").val();
		var form = null;
		var url = $("#winId").attr("src");
		var id = getQueryString(url, "id");
		if(id == null) id = "0";
		var type = getQueryString(url, "type");

		$(function() {

			//初始化控件
			form = $("#certification_form").form();
			$("#entId").val(entId);
			//数据校验
			$("#certification_form").bootstrapValidator({
				message: '请输入有效值',
				feedbackIcons: {
					valid: 'glyphicon glyphicon-ok',
					invalid: 'glyphicon glyphicon-remove',
					validating: 'glyphicon glyphicon-refresh'
				},
				submitHandler: function(validator, userform, submitButton) {
				modals.confirm('确认保存？', function () {
					var params = form.getFormSimpleData();
				
				$.ajax({
					type: "post",
					url: webapi + "/ent_main_certification/saveOrUpdate ",
					data: params,
					success: function (data) {
						if (data.success) {
							var ret = data.ret
							if (id != "0") {
								modals.info("数据更新成功");
							} else { 
								modals.info("数据保存成功");
							}
							
							$('#boot_certification').bootstrapTable('refresh');
							
						} else {
							modals.error("保存失败,请联系管理员!");
						}
					},
				});
				
					
					
					
				});
			},
				fields: {

					certType: {
						validators: {
							notEmpty: {
								message: '请选择认证类型'
							}
						}
					},
					certNo: {
						validators: {
							notEmpty: {
								message: '请选择证书编号'
							}
						}
					},
					certIssueDate: {
						validators: {
							notEmpty: {
								message: '请选择发证日期'
							}
						}
					},
					certValidEndDate: {
						validators: {
							notEmpty: {
								message: '请选择有效期至'
							}
						}
					}

				}
			});

			form.initComponent();

			//上传图片
			$("#file").file({
				title: "请上传附件",
				fileinput: {
					maxFileSize: 10240,
					//theme: "explorer",
					maxFileCount: 1
				},
				fileIdContainer: "[name='fileIds']",
				showContainer: '#file',
				window: false
			});

			//设置只读状态
			if(type && type == 'view') {
				setFormRead();
			}

			//回填id
			if(id != "0") {
				var url = webapi + "/ent_main_certification/getInfo";
				var para = {
					certId: id
				}
				form.ajaxFormData(url, para);
			}
		});

		function resetForm() {
			form.clearForm();
			$("#certification_form").data('bootstrapValidator').resetForm();
		}

		//设置只读
		function setFormRead() {
			$('#certification_form').find('input,textarea,select').not('').attr('disabled', true); 
			$('[type="submit"]').css('display', 'none')

		}
	</script>