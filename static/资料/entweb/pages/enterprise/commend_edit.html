<div class="modal-header">
	<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
		<li class="fa fa-remove"></li>
	</button>
	<h5 class="modal-title">新增营销推介信息</h5>
</div>

<div class="modal-body">

	<form id="commend-form" name="commend-form" class="form-horizontal">
		<input type="hidden" name="recmdId" id="recmdId">
		<input type="hidden" name="entId" id="entId">

		<div class="box-body">

			<div class="form-group">
				<label for="shopName" class="col-sm-2 control-label">营销平台</label>
				<div class="col-sm-9">
					<input type="text" class="form-control" id="shopName" name="shopName" placeholder="营销平台">
				</div>

			</div>

			<div class="form-group">
				<label for="shopUrl" class="col-sm-2 control-label">推介网站</label>
				<div class="col-sm-9">
					<input type="text" class="form-control" id="shopUrl" name="shopUrl" placeholder="推介网站">
				</div>

			</div>
			<div class="form-group">
				<label for="remark" class="col-sm-2 control-label">其他说明</label>
				<div class="col-sm-9">
					<textarea rows="5" class="form-control" id="remark" name="remark" placeholder="其他说明"></textarea>
				</div>


			</div>

			<!-- /.box-body -->
			<div class="box-footer text-right">
				<!--以下两种方式提交验证,根据所需选择-->
				<button type="button" class="btn btn-default" data-btn-type="cancel" data-dismiss="modal">取消</button>
				<button type="submit" class="btn btn-primary" data-btn-type="save">提交</button>
			</div>
		</div>
		<!-- /.box-footer -->
	</form>

</div>
<script>
	var entId = $("#main_entId").val();
	var form = null;
	var url = $("#winId").attr("src");
	var id = getQueryString(url, "id");
	if (id == null) id = "0";
	var type = getQueryString(url, "type");

	$(function () {
		//初始化控件
		form = $("#commend-form").form();

		$("#entId").val(entId);


		//数据校验
		$("#commend-form").bootstrapValidator({
			message: '请输入有效值',
			feedbackIcons: {
				valid: 'glyphicon glyphicon-ok',
				invalid: 'glyphicon glyphicon-remove',
				validating: 'glyphicon glyphicon-refresh'
			},
			submitHandler: function (validator, userform, submitButton) {
				modals.confirm('确认保存？', function () {
					var params = form.getFormSimpleData();

					$.ajax({
						type: "post",
						url: webapi + "/ent_main_recommend/saveOrUpdate ",
						data: params,
						success: function (data) {
							if (data.success) {
								var ret = data.ret
								if (id != "0") {
									modals.info("数据更新成功");
								} else {
									modals.info("数据保存成功");
								}

								$('#boot_recommend').bootstrapTable('refresh');

							} else {
								modals.error("保存失败,请联系管理员!");
							}
						},
					});




				});
			},
			fields: {

				shopName: {
					validators: {
						notEmpty: {
							message: '请输入第三方平台名称'
						}
					}
				},
				shopUrl: {
					validators: {
						notEmpty: {
							message: '请输入第三方平台网店地址'
						}
					}
				}


			}
		});
		form.initComponent();

		//设置只读状态
		if (type && type == 'view') {
			setFormRead();
		}
		//回填id
		if (id != "0") {
			var url = webapi + "/ent_main_recommend/getInfo";
			var para = {
				recmdId: id
			}
			form.ajaxFormData(url, para);

		}
	});





	function resetForm() {
		form.clearForm();
		$("#commend-form").data('bootstrapValidator').resetForm();
	}

	//设置只读
	function setFormRead() {
		$('#place-form').find('input,textarea,select').not('').attr('disabled', true);
		$('[type="submit"]').css('display', 'none')

	}
</script>
