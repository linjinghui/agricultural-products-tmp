<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="keywords" content="">
	<meta name="description" content="">
 <meta http-equiv="Pragma" content="no-cache"> 
<meta http-equiv="Cache-Control" content="no-cache"> 
<meta http-equiv="Expires" content="-1">
	<title>福建省农产品安全追溯监管信息平台</title>
	<!-- Tell the browser to be responsive to screen width -->
	<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
	<!--
	<link rel="shortcut icon" type="image/x-icon" href="dist/common/favicon.ico" media="screen" />
	-->
	<!-- Bootstrap 3.3.6 -->
	<link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
	<!-- Font Awesome -->
	<link rel="stylesheet" href="bower_components/font-awesome/css/font-awesome.min.css">

	<link rel="stylesheet" href="dist/common/css/base.css">

	<link rel="stylesheet" href="plugins/bootstrap-validator/dist/css/bootstrap-validator.css" />
	<link rel="stylesheet" href="plugins/iCheck/all.css">
	<!-- daterangepicker -->
	<!--<link rel="stylesheet" href="plugins/daterangepicker/daterangepicker.css">-->
	<link rel="stylesheet" href="plugins/datepicker/datepicker3.css">
	<link rel="stylesheet" href="plugins/select2/select2.min.css">

	<link rel="stylesheet" href="plugins/bootstrap-treeview/bootstrap-treeview.min.css" />

	<link rel="stylesheet" href="dist/css/AdminLTE.min.css">
	<link rel="stylesheet" href="dist/css/skins/_all-skins.min.css">
	<!-- Ionicons -->
	<link rel="stylesheet" href="bower_components/Ionicons/css/ionicons.min.css">
	<link rel="stylesheet" href="bower_components/bootstrap-table-develop/dist/bootstrap-table.min.css" />
	<link rel="stylesheet" href="bower_components/bootstrap-fileinput-master/css/fileinput.min.css" />





	<style>
		.spanred {
			color: red;
		}

		.box.box-info {
			border-top-color: #ffffff;
		}
	</style>


</head>

<body class="hold-transition skin-blue sidebar-mini fixed">
	<a name="main"></a>
	<div class="wrapper">

		<header class="main-header">

			<!-- Logo -->
			<a href="main.html" class="logo">
				<!-- mini logo for sidebar mini 50x50 pixels -->
				<span class="logo-mini">
					<b></b>
				</span>
				<!-- logo for regular state and mobile devices -->
				<span class="logo-lg">
					<b>生产主体平台</b>
				</span>
			</a>
			<!-- Header Navbar: style can be found in header.less -->
			<nav class="navbar navbar-static-top">
				<!-- Sidebar toggle button-->
				<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
					<span class="sr-only">Toggle navigation</span>
				</a>

				<!-- Navbar Right Menu -->

				<div class="navbar-custom-menu">
					<ul class="nav navbar-nav">

						<li class="dropdown notifications-menu">
							<a href="#" onclick="loadPage('homePage.html');">
								<i class="fa fa-home " style="font-size:20px"></i>

							</a>
						</li>

						<!-- Notifications: style can be found in dropdown.less -->
						<li class="dropdown notifications-menu">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown">
								<i class="fa fa-bell-o"></i>
								<span class="label label-warning">10</span>
							</a>
							<ul class="dropdown-menu">
								<li class="header">You have 10 notifications</li>
								<li>
									<!-- inner menu: contains the actual data -->
									<ul class="menu">
										<li>
											<a href="#">
												<i class="fa fa-users text-aqua"></i> 5 new members joined today
											</a>
										</li>
										<li>
											<a href="#">
												<i class="fa fa-warning text-yellow"></i> Very long description here that may not fit into the page and may cause design problems
											</a>
										</li>
										<li>
											<a href="#">
												<i class="fa fa-users text-red"></i> 5 new members joined
											</a>
										</li>
										<li>
											<a href="#">
												<i class="fa fa-shopping-cart text-green"></i> 25 sales made
											</a>
										</li>
										<li>
											<a href="#">
												<i class="fa fa-user text-red"></i> You changed your username
											</a>
										</li>
									</ul>
								</li>
								<li class="footer">
									<a href="#">View all</a>
								</li>
							</ul>
						</li>

						<!-- User Account: style can be found in dropdown.less -->
						<li class="dropdown user user-menu">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown">
								<img src="dist/img/avatar5.png" class="user-image" alt="User Image">
								<span class="hidden-xs" id="spanName"></span>
							</a>
							<ul class="dropdown-menu">
								<!-- User image -->
								<li class="user-header">
									<img src="dist/img/avatar5.png" class="img-circle" alt="User Image">

									<p>
										<span id="user-name"></span>

										<small>上次登录时间
											<span>2018-05-08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 15:20:58</span>
										</small>
									</p>
								</li>
								<!-- Menu Body -->
								<li class="user-body" style="background-color: #f9f9f9">
									<div class="row">
										<div class="col-xs-4 text-center">
											<a href="personal.html">个人中心</a>
										</div>
										<div class="col-xs-4 text-center">
										</div>
										<div class="col-xs-4 text-center">
											<a href="modify_password.html">修改密码</a>
										</div>
									</div>
									<!-- /.row -->
								</li>
								<!-- Menu Footer-->
								<li class="user-footer">
									<div class="pull-left">
									</div>
									<div class="pull-right">
										<a href="#" class="btn btn-default btn-flat" id="logout">退出登录</a>
									</div>
								</li>
							</ul>
						</li>
						<!-- Control Sidebar Toggle Button -->
						<li>
							<a href="#" data-toggle="control-sidebar">
								<!--
								<i class="fa fa-gears"></i>
								-->
							</a>
						</li>
					</ul>
				</div>

			</nav>
		</header>
		<!-- Left side column. contains the logo and sidebar -->
		<aside class="main-sidebar">
			<!-- sidebar: style can be found in sidebar.less -->
			<section class="sidebar">
				<!-- Sidebar user panel -->
				<div class="user-panel">
					<div class="pull-left image">
						<img src="dist/img/avatar5.png" class="img-circle" alt="User Image">
					</div>
					<div class="pull-left info">
						<p></p>
						<a href="#">
							<i class="fa fa-circle text-success"></i> Online</a>
					</div>
				</div>
				<!-- search form 
			<!--	<form action="#" method="get" class="sidebar-form">
					<div class="input-group">
						<input type="text" name="q" class="form-control" placeholder="">
						<span class="input-group-btn">
							<button type="submit" name="search" id="search-btn" class="btn btn-flat">
								<i class="fa fa-search"></i>
							</button>
						</span>
					</div>
				</form>-->
				-->
				<!-- /.search form -->
				<!-- sidebar menu: : style can be found in sidebar.less -->

				<br />
				<ul class="sidebar-menu">

				</ul>
			</section>
			<!-- /.sidebar -->
		</aside>

		<!-- Content Wrapper. Contains page content -->
		<div class="content-wrapper" id="mainDiv">

		</div>
		<!-- /.content-wrapper -->

		<footer class="main-footer text-center">
		</footer>

		<!-- Control Sidebar -->
		<aside class="control-sidebar control-sidebar-dark">
			<!-- Create the tabs -->
			<ul class="nav nav-tabs nav-justified control-sidebar-tabs">
				<li>
					<a href="#control-sidebar-home-tab" data-toggle="tab">
						<i class="fa fa-home"></i>
					</a>
				</li>
				<li>
					<a href="#control-sidebar-settings-tab" data-toggle="tab">
						<i class="fa fa-gears"></i>
					</a>
				</li>
			</ul>
			<!-- Tab panes -->
			<div class="tab-content">
				<!-- Home tab content -->
				<div class="tab-pane" id="control-sidebar-home-tab">
					<h3 class="control-sidebar-heading">Recent Activity</h3>
					<ul class="control-sidebar-menu">
						<li>
							<a href="javascript:void(0)">
								<i class="menu-icon fa fa-birthday-cake bg-red"></i>

								<div class="menu-info">
									<h4 class="control-sidebar-subheading">Langdon's Birthday</h4>

									<p>Will be 23 on April 24th</p>
								</div>
							</a>
						</li>
						<li>
							<a href="javascript:void(0)">
								<i class="menu-icon fa fa-user bg-yellow"></i>

								<div class="menu-info">
									<h4 class="control-sidebar-subheading">Frodo Updated His Profile</h4>

									<p>New phone +1(800)555-1234</p>
								</div>
							</a>
						</li>
						<li>
							<a href="javascript:void(0)">
								<i class="menu-icon fa fa-envelope-o bg-light-blue"></i>

								<div class="menu-info">
									<h4 class="control-sidebar-subheading">Nora Joined Mailing List</h4>

									<p>nora@example.com</p>
								</div>
							</a>
						</li>
						<li>
							<a href="javascript:void(0)">
								<i class="menu-icon fa fa-file-code-o bg-green"></i>

								<div class="menu-info">
									<h4 class="control-sidebar-subheading">Cron Job 254 Executed</h4>

									<p>Execution time 5 seconds</p>
								</div>
							</a>
						</li>
					</ul>
					<!-- /.control-sidebar-menu -->

					<h3 class="control-sidebar-heading">Tasks Progress</h3>
					<ul class="control-sidebar-menu">
						<li>
							<a href="javascript:void(0)">
								<h4 class="control-sidebar-subheading">
									Custom Template Design
									<span class="label label-danger pull-right">70%</span>
								</h4>

								<div class="progress progress-xxs">
									<div class="progress-bar progress-bar-danger" style="width: 70%"></div>
								</div>
							</a>
						</li>
						<li>
							<a href="javascript:void(0)">
								<h4 class="control-sidebar-subheading">
									Update Resume
									<span class="label label-success pull-right">95%</span>
								</h4>

								<div class="progress progress-xxs">
									<div class="progress-bar progress-bar-success" style="width: 95%"></div>
								</div>
							</a>
						</li>
						<li>
							<a href="javascript:void(0)">
								<h4 class="control-sidebar-subheading">
									Laravel Integration
									<span class="label label-warning pull-right">50%</span>
								</h4>

								<div class="progress progress-xxs">
									<div class="progress-bar progress-bar-warning" style="width: 50%"></div>
								</div>
							</a>
						</li>
						<li>
							<a href="javascript:void(0)">
								<h4 class="control-sidebar-subheading">
									Back End Framework
									<span class="label label-primary pull-right">68%</span>
								</h4>

								<div class="progress progress-xxs">
									<div class="progress-bar progress-bar-primary" style="width: 68%"></div>
								</div>
							</a>
						</li>
					</ul>
					<!-- /.control-sidebar-menu -->

				</div>
				<!-- /.tab-pane -->

				<!-- Settings tab content -->
				<div class="tab-pane" id="control-sidebar-settings-tab">
					<form method="post">
						<h3 class="control-sidebar-heading">General Settings</h3>

						<div class="form-group">
							<label class="control-sidebar-subheading">
								Report panel usage
								<input type="checkbox" class="pull-right" checked>
							</label>

							<p>
								Some information about this general settings option
							</p>
						</div>
						<!-- /.form-group -->

						<div class="form-group">
							<label class="control-sidebar-subheading">
								Allow mail redirect
								<input type="checkbox" class="pull-right" checked>
							</label>

							<p>
								Other sets of options are available
							</p>
						</div>
						<!-- /.form-group -->

						<div class="form-group">
							<label class="control-sidebar-subheading">
								Expose author name in posts
								<input type="checkbox" class="pull-right" checked>
							</label>

							<p>
								Allow the user to show his name in blog posts
							</p>
						</div>
						<!-- /.form-group -->

						<h3 class="control-sidebar-heading">Chat Settings</h3>

						<div class="form-group">
							<label class="control-sidebar-subheading">
								Show me as online
								<input type="checkbox" class="pull-right" checked>
							</label>
						</div>
						<!-- /.form-group -->

						<div class="form-group">
							<label class="control-sidebar-subheading">
								Turn off notifications
								<input type="checkbox" class="pull-right">
							</label>
						</div>
						<!-- /.form-group -->

						<div class="form-group">
							<label class="control-sidebar-subheading">
								Delete chat history
								<a href="javascript:void(0)" class="text-red pull-right">
									<i class="fa fa-trash-o"></i>
								</a>
							</label>
						</div>
						<!-- /.form-group -->
					</form>
				</div>
				<!-- /.tab-pane -->
			</div>
		</aside>
		<!-- /.control-sidebar -->
		<!-- Add the sidebar's background. This div must be placed
       immediately after the control sidebar -->
		<div class="control-sidebar-bg"></div>


		<div id="spin">

		</div>

		<div class="form-group">
			<input type="hidden" id="main_entId" name="main_entId">
			<input type="hidden" id="userName" name="userName">
			<input type="hidden" id="userId" name="userId">
		</div>

	</div>

	<script type="text/javascript">
		var basePath = "";
		// var webapi = "http://117.27.151.130:10205";
		//var webapi = "http://192.168.1.149:10205";
	</script>
	<!-- jQuery 3 -->
	<script src="bower_components/jquery/dist/jquery.min.js"></script>
	<!-- jQuery UI 1.11.4 -->
	<script src="bower_components/jquery-ui/jquery-ui.min.js"></script>

	<script src="dist/js/dist/js/app.min.js"></script>

	<!-- Bootstrap 3.3.6 -->
	<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
	<!-- FastClick -->
	<script src="bower_components/fastclick/lib/fastclick.js"></script>

	<script src="bower_components/jquery-slimscroll/jquery.slimscroll.min.js"></script>

	<!-- form -->
	<script src="plugins/bootstrap-validator/dist/js/bootstrap-validator.js"></script>
	<script src="plugins/iCheck/icheck.min.js"></script>

	<!--daterangepicker-->
	<script src="bower_components/bootstrap-daterangepicker/daterangepicker.js"></script>

	<script src="plugins/datepicker/bootstrap-datepicker.js"></script>
	<script src="plugins/datepicker/locales/bootstrap-datepicker.zh-CN.js"></script>

	<!-- treeview -->
	<script src="plugins/bootstrap-treeview/bootstrap-treeview.min.js"></script>

	<!--select2-->
	<script src="bower_components/select2/dist/js/select2.full.min.js"></script>


	<script type="text/javascript" src="dist/common/js/base.js"></script>
	<script type="text/javascript" src="dist/common/js/base-modal.js"></script>
	<script type="text/javascript" src="dist/common/js/base-form.js"></script>
	<script type="text/javascript" src="dist/common/js/base-datasource.js"></script>
	<script type="text/javascript" src="dist/common/js/base-file.js"></script>
	<script type="text/javascript" src="dist/js/common.js"></script>



	<!--bootstrap-table v1.12.1-->
	<script type="text/javascript" src="bower_components/bootstrap-table-develop/dist/bootstrap-table.js"></script>
	<script type="text/javascript" src="bower_components/bootstrap-table-develop/dist/locale/bootstrap-table-zh-CN.js"></script>
	<script type="text/javascript" src="bower_components/bootstrap-table-develop/dist/extensions/export/bootstrap-table-export.js"></script>

	<!--
	<script src="bower_components/tableExport/libs/pdfmake/pdfmake.min.js"></script>
	<script src="bower_components/tableExport/libs/pdfmake/vfs_fonts.js"></script>
	<script type="text/javascript" src="bower_components/tableExport/libs/FileSaver/FileSaver.min.js"></script>
	<script type="text/javascript" src="bower_components/tableExport/libs/jsPDF/jspdf.min.js"></script>
	<script type="text/javascript" src="bower_components/tableExport/libs/jsPDF-AutoTable/jspdf.plugin.autotable.js"></script>
	-->

	<script type="text/javascript" src="bower_components/tableExport/tableExport.js"></script>
	<script type="text/javascript" src="https://cdn.bootcss.com/spin.js/2.3.2/spin.js"></script>
	<script type="text/javascript" src="dist/js/spin.common.js"></script>
	<script type="text/javascript" src="bower_components/ckeditor-releases-master/ckeditor.js"></script>
	<script type="text/javascript" src="bower_components/bootstrap-fileinput-master/js/fileinput.min.js"></script>
	<script type="text/javascript" src="bower_components/bootstrap-fileinput-master/js/locales/zh.js"></script>

	<!-- 加入页面的的脚本 -->
	<script>
		$.ajaxSetup({
			cache: false,
			//timeout: 10000,
			dataType: "json",
			xhrFields: {
				withCredentials: true
			},
			crossDomain: true,
			error: function (jqXHR, textStatus, errorThrown) {
				//	alert("error")
				console.info("系统异常：" + jqXHR.status);
				console.info("系统异常：" + textStatus);
				//alert(jqXHR.status)
				//alert(textStatus)
				switch (jqXHR.status) {
					case (0):
						window.location.href = "login.html"
						break;
					case (500):
						alert("服务器系统内部错误");
						break;
					case (401):
						alert("未登录");
						//window.location.href = "login.html"
						break;
					case (403):
						alert("无权限执行此操作");
						break;
					case (408):
						alert("请求超时");
						break;
					default:
						alert("未知错误");
						//window.location.href = "login.html"
						break;
				}
			},

			complete: function (XMLHttpRequest, textStatus) {
				if (textStatus != "success") {
					//	window.location.replace("login.html");
					//	return;
				};

				if (textStatus == "success") {
					/*
					var responseText = XMLHttpRequest.responseText;
					
					//var data = JSON.parse(responseText);
					var data=eval("("+responseText+")");

					if (data.code != undefined && data.code != "0") {
						window.location.replace("login.html");
					}
					*/

				};
			}

		});
		
		//加载菜单
		var menuData;
		var url = "data/menu.json";
		$.get(url, null, function (data) {
			//console.log(data);
			var $li, $menu_f_ul, $menu_s, $li_s, $menu_s_ul;
			menuData = data;
			$.each(data, function (index, item) {
				if (item.levelCode.length == 1) {
					$li = $('<li class="treeview"></li>');
					var $menu_f = $('<a href="#" name="menu" data-url="' + item.url + '" onclick=loadPage("' + item.url +
						'")<i class="' + item.icon + '"></i> <span>' + item.name + '</span>\n' +
						' <span class="pull-right-container">\n' +
						'<i class="fa fa-angle-left pull-right"></i>\n' +
						'</span></a>');
					$li.append($menu_f);
					$("ul.sidebar-menu").append($li);
				} else if (item.levelCode.length == 6) {
					$li = $('<li class="treeview"></li>');
					var $menu_f = $('<a href="#">\n' +
						'<i class="' + item.icon + '"></i> <span>' + item.name + '</span>\n' +
						' <span class="pull-right-container">\n' +
						'<i class="fa fa-angle-left pull-right"></i>\n' +
						'</span></a>');
					$li.append($menu_f);
					$menu_f_ul = $('<ul class="treeview-menu"></ul>');
					$li.append($menu_f_ul);
					$("ul.sidebar-menu").append($li);
				} else if (item.levelCode.length == 12) {
					if (hasChildMenu(item.id)) {
						$li_s = $('<li class="treeview"></li>');
						$menu_s = $('<a href="#">\n' +
							'<i class="' + item.icon + '"></i> <span>' + item.name + '</span>\n' +
							' <span class="pull-right-container">\n' +
							'<i class="fa fa-angle-left pull-right"></i>\n' +
							'</span></a>');
						$li_s.append($menu_s);
						$menu_s_ul = $('<ul class="treeview-menu"></ul>');
						$li_s.append($menu_s_ul);
						$menu_f_ul.append($li_s);
					} else {
						$menu_s = $('<li><a href="#" name="menu" data-url="' + item.url + '" onclick=loadPage("' + item.url +
							'")><i class="' + item.icon + '"></i>' + item.name +
							'</a></li>');
						$menu_f_ul.append($menu_s);
					}
				} else if (item.levelCode.length == 18) {
					$menu_t = $('<li><a href="#" name="menu" data-url="' + item.url + '" onclick=loadPage("' + item.url +
						'") ><i class="' + item.icon + '"></i>' + item.name +
						'</a></li>');
					$menu_s_ul.append($menu_t);
				}
			});
		});

		//判断当前二级菜单是否有包含三级菜单
		function hasChildMenu(parentId) {
			if (!menuData)
				return false;
			for (var i = 0; i < menuData.length; i++) {
				var item = menuData[i];
				if (item.parentId == parentId) {
					return true;
				}
			}
			return false;
		}



		$(function () {
			loadPage("homePage.html");
			$("a[name='menu']").click(function (evt) {
				//loadPage($(this).data("url"));
				$("ul.treeview-menu li").removeClass("active");
				$(this).parent().addClass("active");
			});

			initUserInfo()
		});


		//获取登录用户相关信息
		var initUserInfo = function () {

			var username = "admin"
			$("#spanName").html(username);
			$("#user-name").html(username);
			$("#userName").val(username);


			$.ajax({
				type: "get",
				url: webapi + "/ent_sys_entuser/getEntUser",
				data: {
					username: "admin"
				},
				success: function (data) {
					//	alert(data.success)
					if (data.success) {
						var ret = data.ret
						$("#main_entId").val(ret.entId);
						
						//主体信息补录
						//completeRegister(ret)

					} else {
						modals.error("获取用户信息异常,请检查");
						location.href = "login.html";
					}
				}
			});

		}

		var  completeRegister = function (ret) {
			var winId = "register_complete_win"; 
			if(ret.entName==null||ret.entUnicode==null||ret.entType==null||
			ret.busiPlace==null||ret.entIndustry==null||ret.entIndustrySub==null)
			{
				modals.openWin({
					winId: winId,
					title: '生产主体信息补录',
					width: '1200px',
					//height: '800px',
					url: "register_complete.html",
					hideFunc: function() {
						//modals.info("hide me");
					},
					showFunc: function() {
						//modals.info("show me");
					}
				});
				
			}
			
			
		}

		$("#logout").click(function () {
			modals.confirm('您确定要退出系统？', function () {
				var url = webapi + "/logout";
				$.ajax({
						url: url,
						success: function (data) {
							if (data.success) {


							}
						},
						error: function (e, jqxhr, settings, exception) {},
					}),

					location.href = "login.html";
			})

		});
	</script>
</body>

</html>
